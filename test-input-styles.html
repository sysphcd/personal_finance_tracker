<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>輸入區域樣式測試 - Task 2.2</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
        }
        .test-result {
            padding: 10px;
            margin: 5px 0;
            border-radius: 5px;
        }
        .pass {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .fail {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .summary {
            margin-top: 20px;
            padding: 15px;
            background-color: #e7f3ff;
            border-radius: 5px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <h1>個人記帳本 - 輸入區域樣式測試 (Task 2.2)</h1>
    <p>需求：3.2, 3.3, 3.4 - 輸入欄位和下拉選單的樣式、綠色新增按鈕、圓角和間距</p>
    <div id="test-results"></div>
    <div id="test-summary" class="summary"></div>

    <!-- 載入要測試的 HTML -->
    <iframe id="test-frame" src="index.html" style="display: none;"></iframe>

    <script>
        // 測試結果容器
        const resultsContainer = document.getElementById('test-results');
        const summaryContainer = document.getElementById('test-summary');
        let passCount = 0;
        let failCount = 0;

        // 測試輔助函式
        function assert(condition, testName, details = '') {
            const resultDiv = document.createElement('div');
            resultDiv.className = 'test-result';
            
            if (condition) {
                resultDiv.classList.add('pass');
                resultDiv.textContent = `✓ PASS: ${testName}`;
                passCount++;
            } else {
                resultDiv.classList.add('fail');
                resultDiv.textContent = `✗ FAIL: ${testName}${details ? ' - ' + details : ''}`;
                failCount++;
            }
            
            resultsContainer.appendChild(resultDiv);
        }

        // 輔助函式：檢查顏色是否為綠色
        function isGreenColor(color) {
            // 檢查常見的綠色值
            const greenColors = [
                'rgb(76, 175, 80)',  // #4CAF50
                '#4caf50',
                '#4CAF50',
                'rgb(69, 160, 73)',  // #45a049 (hover)
                '#45a049'
            ];
            
            const normalizedColor = color.toLowerCase().replace(/\s/g, '');
            return greenColors.some(green => 
                normalizedColor === green.toLowerCase().replace(/\s/g, '')
            ) || normalizedColor.includes('green');
        }

        // 輔助函式：檢查是否有圓角
        function hasRoundedCorners(borderRadius) {
            const radius = parseInt(borderRadius);
            return radius > 0;
        }

        // 等待 iframe 載入完成後執行測試
        window.addEventListener('load', () => {
            const iframe = document.getElementById('test-frame');
            
            iframe.addEventListener('load', () => {
                const doc = iframe.contentDocument || iframe.contentWindow.document;
                const win = iframe.contentWindow;
                
                // 測試 1: 檢查輸入區域容器存在
                const inputSection = doc.querySelector('.input-section');
                assert(inputSection !== null, '輸入區域容器 (.input-section) 存在');
                
                // 測試 2: 檢查金額輸入欄位樣式
                const amountInput = doc.getElementById('amountInput');
                assert(amountInput !== null, '金額輸入欄位 (#amountInput) 存在');
                
                if (amountInput) {
                    const inputStyle = win.getComputedStyle(amountInput);
                    
                    // 測試 2.1: 檢查輸入欄位有內邊距
                    const padding = parseInt(inputStyle.padding) || parseInt(inputStyle.paddingTop);
                    assert(
                        padding > 0,
                        '金額輸入欄位有適當的內邊距 (padding)',
                        `實際值: ${padding}px`
                    );
                    
                    // 測試 2.2: 檢查輸入欄位有邊框
                    const border = inputStyle.border || inputStyle.borderWidth;
                    const hasBorder = border && border !== 'none' && border !== '0px';
                    assert(
                        hasBorder,
                        '金額輸入欄位有邊框 (border)',
                        `實際值: ${border}`
                    );
                    
                    // 測試 2.3: 檢查輸入欄位有圓角 (需求 3.3)
                    const borderRadius = inputStyle.borderRadius;
                    assert(
                        hasRoundedCorners(borderRadius),
                        '金額輸入欄位有圓角 (border-radius)',
                        `實際值: ${borderRadius}`
                    );
                }
                
                // 測試 3: 檢查類別下拉選單樣式
                const categorySelect = doc.getElementById('categorySelect');
                assert(categorySelect !== null, '類別下拉選單 (#categorySelect) 存在');
                
                if (categorySelect) {
                    const selectStyle = win.getComputedStyle(categorySelect);
                    
                    // 測試 3.1: 檢查下拉選單有內邊距
                    const padding = parseInt(selectStyle.padding) || parseInt(selectStyle.paddingTop);
                    assert(
                        padding > 0,
                        '類別下拉選單有適當的內邊距 (padding)',
                        `實際值: ${padding}px`
                    );
                    
                    // 測試 3.2: 檢查下拉選單有邊框
                    const border = selectStyle.border || selectStyle.borderWidth;
                    const hasBorder = border && border !== 'none' && border !== '0px';
                    assert(
                        hasBorder,
                        '類別下拉選單有邊框 (border)',
                        `實際值: ${border}`
                    );
                    
                    // 測試 3.3: 檢查下拉選單有圓角 (需求 3.3)
                    const borderRadius = selectStyle.borderRadius;
                    assert(
                        hasRoundedCorners(borderRadius),
                        '類別下拉選單有圓角 (border-radius)',
                        `實際值: ${borderRadius}`
                    );
                }
                
                // 測試 4: 檢查新增按鈕樣式
                const addBtn = doc.getElementById('addBtn');
                assert(addBtn !== null, '新增按鈕 (#addBtn) 存在');
                
                if (addBtn) {
                    const btnStyle = win.getComputedStyle(addBtn);
                    
                    // 測試 4.1: 檢查按鈕背景色為綠色 (需求 3.2)
                    const bgColor = btnStyle.backgroundColor;
                    assert(
                        isGreenColor(bgColor),
                        '新增按鈕背景色為綠色 (需求 3.2)',
                        `實際值: ${bgColor}`
                    );
                    
                    // 測試 4.2: 檢查按鈕文字顏色為白色
                    const color = btnStyle.color;
                    const isWhite = color === 'rgb(255, 255, 255)' || 
                                   color === '#fff' || 
                                   color === '#ffffff' ||
                                   color === 'white';
                    assert(
                        isWhite,
                        '新增按鈕文字顏色為白色',
                        `實際值: ${color}`
                    );
                    
                    // 測試 4.3: 檢查按鈕有圓角 (需求 3.3)
                    const borderRadius = btnStyle.borderRadius;
                    assert(
                        hasRoundedCorners(borderRadius),
                        '新增按鈕有圓角 (border-radius) (需求 3.3)',
                        `實際值: ${borderRadius}`
                    );
                    
                    // 測試 4.4: 檢查按鈕有內邊距
                    const padding = parseInt(btnStyle.padding) || parseInt(btnStyle.paddingTop);
                    assert(
                        padding > 0,
                        '新增按鈕有適當的內邊距 (padding)',
                        `實際值: ${padding}px`
                    );
                    
                    // 測試 4.5: 檢查按鈕有游標指標
                    const cursor = btnStyle.cursor;
                    assert(
                        cursor === 'pointer',
                        '新增按鈕有游標指標 (cursor: pointer)',
                        `實際值: ${cursor}`
                    );
                }
                
                // 測試 5: 檢查輸入區域元素之間的間距 (需求 3.4)
                if (inputSection) {
                    const sectionStyle = win.getComputedStyle(inputSection);
                    
                    // 檢查是否使用 flexbox 或 grid 佈局
                    const display = sectionStyle.display;
                    const isFlexOrGrid = display === 'flex' || display === 'grid';
                    
                    if (isFlexOrGrid) {
                        // 檢查 gap 屬性
                        const gap = sectionStyle.gap || sectionStyle.columnGap;
                        const hasGap = gap && gap !== 'normal' && gap !== '0px';
                        assert(
                            hasGap,
                            '輸入區域元素之間有適當的間距 (gap) (需求 3.4)',
                            `實際值: ${gap}`
                        );
                    } else {
                        // 如果不是 flex/grid，檢查 margin
                        assert(
                            true,
                            '輸入區域使用其他方式設定間距 (需求 3.4)'
                        );
                    }
                    
                    // 測試 5.2: 檢查輸入區域本身有下邊距
                    const marginBottom = parseInt(sectionStyle.marginBottom);
                    assert(
                        marginBottom > 0,
                        '輸入區域有適當的下邊距 (margin-bottom) (需求 3.4)',
                        `實際值: ${marginBottom}px`
                    );
                }
                
                // 顯示測試摘要
                const total = passCount + failCount;
                summaryContainer.textContent = `測試完成：共 ${total} 個測試，${passCount} 個通過，${failCount} 個失敗`;
                
                if (failCount === 0) {
                    summaryContainer.style.backgroundColor = '#d4edda';
                    summaryContainer.style.color = '#155724';
                } else {
                    summaryContainer.style.backgroundColor = '#f8d7da';
                    summaryContainer.style.color = '#721c24';
                }
            });
        });
    </script>
</body>
</html>
